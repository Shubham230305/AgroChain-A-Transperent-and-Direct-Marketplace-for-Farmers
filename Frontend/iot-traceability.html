<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Traceability - AgroChain</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="iot-traceability.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="project-index.html" class="back-btn" title="Back to Project Index" style="margin-right: 15px;">
                    <i class="fas fa-arrow-left"></i>
                </a>
                <i class="fas fa-leaf"></i>
                <span>AgroChain</span>
            </div>
            <div class="nav-menu">
                <a href="#" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
                <a href="#" class="nav-link">
                    <i class="fas fa-seedling"></i>
                    <span>Crops</span>
                </a>
                <a href="#" class="nav-link">
                    <i class="fas fa-chart-line"></i>
                    <span>Market</span>
                </a>
                <a href="#" class="nav-link active">
                    <i class="fas fa-route"></i>
                    <span>Traceability</span>
                </a>
                <div class="nav-profile">
                    <div class="profile-info">
                        <div class="profile-name">Rohan Landge</div>
                        <div class="profile-role">Farmer</div>
                    </div>
                    <div class="profile-avatar">RL</div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Header Section -->
        <div class="header-section">
            <h1><i class="fas fa-route"></i> IoT Crop Traceability</h1>
            <p>Track your crop's journey from harvest to delivery with real-time IoT sensor data</p>
        </div>

        <!-- Crop Selection -->
        <div class="crop-selection-section">
            <div class="crop-selector">
                <label for="cropSelect">Select Crop Batch:</label>
                <select id="cropSelect" class="crop-select">
                    <option value="">Choose a crop batch...</option>
                    <option value="wheat-001">Wheat Batch #001 - Harvested 2 days ago</option>
                    <option value="rice-002">Rice Batch #002 - In Storage</option>
                    <option value="cotton-003">Cotton Batch #003 - In Transit</option>
                    <option value="soybean-004">Soybean Batch #004 - Delivered</option>
                </select>
            </div>
            <button class="refresh-btn" id="refreshData">
                <i class="fas fa-sync-alt"></i>
                Refresh Data
            </button>
        </div>

        <!-- IoT Sensor Dashboard -->
        <div class="iot-dashboard">
            <h2><i class="fas fa-microchip"></i> Real-time IoT Sensors</h2>
            <div class="sensor-cards">
                <!-- Temperature Sensor -->
                <div class="sensor-card temperature">
                    <div class="sensor-header">
                        <div class="sensor-icon">
                            <i class="fas fa-thermometer-half"></i>
                        </div>
                        <div class="sensor-info">
                            <h3>Temperature</h3>
                            <span class="sensor-location">Storage Unit A</span>
                        </div>
                        <div class="sensor-status online">
                            <i class="fas fa-circle"></i>
                        </div>
                    </div>
                    <div class="sensor-data">
                        <div class="current-value">
                            <span class="value">22.5</span>
                            <span class="unit">°C</span>
                        </div>
                        <div class="sensor-range">
                            <div class="range-bar">
                                <div class="range-fill" style="width: 75%"></div>
                            </div>
                            <div class="range-labels">
                                <span>15°C</span>
                                <span>30°C</span>
                            </div>
                        </div>
                    </div>
                    <div class="sensor-footer">
                        <div class="last-updated">
                            <i class="fas fa-clock"></i>
                            Updated 2 min ago
                        </div>
                        <div class="trend-indicator stable">
                            <i class="fas fa-minus"></i>
                        </div>
                    </div>
                </div>

                <!-- Humidity Sensor -->
                <div class="sensor-card humidity">
                    <div class="sensor-header">
                        <div class="sensor-icon">
                            <i class="fas fa-tint"></i>
                        </div>
                        <div class="sensor-info">
                            <h3>Humidity</h3>
                            <span class="sensor-location">Storage Unit A</span>
                        </div>
                        <div class="sensor-status online">
                            <i class="fas fa-circle"></i>
                        </div>
                    </div>
                    <div class="sensor-data">
                        <div class="current-value">
                            <span class="value">65</span>
                            <span class="unit">%</span>
                        </div>
                        <div class="sensor-range">
                            <div class="range-bar">
                                <div class="range-fill" style="width: 65%"></div>
                            </div>
                            <div class="range-labels">
                                <span>40%</span>
                                <span>80%</span>
                            </div>
                        </div>
                    </div>
                    <div class="sensor-footer">
                        <div class="last-updated">
                            <i class="fas fa-clock"></i>
                            Updated 2 min ago
                        </div>
                        <div class="trend-indicator increasing">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                    </div>
                </div>

                <!-- GPS Location -->
                <div class="sensor-card gps">
                    <div class="sensor-header">
                        <div class="sensor-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div class="sensor-info">
                            <h3>GPS Location</h3>
                            <span class="sensor-location">Transport Vehicle</span>
                        </div>
                        <div class="sensor-status online">
                            <i class="fas fa-circle"></i>
                        </div>
                    </div>
                    <div class="sensor-data">
                        <div class="location-info">
                            <div class="coordinates">
                                <span class="lat">19.0760° N</span>
                                <span class="lng">72.8777° E</span>
                            </div>
                            <div class="location-address">
                                Mumbai, Maharashtra
                            </div>
                        </div>
                        <div class="location-accuracy">
                            <span class="accuracy">Accuracy: ±5m</span>
                        </div>
                    </div>
                    <div class="sensor-footer">
                        <div class="last-updated">
                            <i class="fas fa-clock"></i>
                            Updated 1 min ago
                        </div>
                        <div class="trend-indicator moving">
                            <i class="fas fa-truck"></i>
                        </div>
                    </div>
                </div>

                <!-- Air Quality -->
                <div class="sensor-card air-quality">
                    <div class="sensor-header">
                        <div class="sensor-icon">
                            <i class="fas fa-wind"></i>
                        </div>
                        <div class="sensor-info">
                            <h3>Air Quality</h3>
                            <span class="sensor-location">Storage Unit A</span>
                        </div>
                        <div class="sensor-status online">
                            <i class="fas fa-circle"></i>
                        </div>
                    </div>
                    <div class="sensor-data">
                        <div class="current-value">
                            <span class="value">Good</span>
                            <span class="aqi">AQI: 45</span>
                        </div>
                        <div class="quality-indicator">
                            <div class="quality-bar">
                                <div class="quality-fill good" style="width: 45%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="sensor-footer">
                        <div class="last-updated">
                            <i class="fas fa-clock"></i>
                            Updated 3 min ago
                        </div>
                        <div class="trend-indicator stable">
                            <i class="fas fa-minus"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Journey Timeline -->
        <div class="journey-timeline">
            <h2><i class="fas fa-route"></i> Crop Journey Timeline</h2>
            <div class="timeline-container">
                <!-- Harvest Stage -->
                <div class="timeline-stage completed" data-stage="harvest">
                    <div class="stage-icon">
                        <i class="fas fa-hand-holding-seedling"></i>
                    </div>
                    <div class="stage-content">
                        <div class="stage-header">
                            <h3>Harvest</h3>
                            <span class="stage-date">Nov 15, 2024</span>
                        </div>
                        <div class="stage-details">
                            <div class="detail-item">
                                <i class="fas fa-user"></i>
                                <span>Harvested by: Rajesh Kumar</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Field A, Block 3, Nashik</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-weight"></i>
                                <span>Quantity: 500kg</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-certificate"></i>
                                <span>Quality: Grade A</span>
                            </div>
                        </div>
                        <div class="stage-iot">
                            <div class="iot-badge">
                                <i class="fas fa-thermometer-half"></i>
                                <span>24°C</span>
                            </div>
                            <div class="iot-badge">
                                <i class="fas fa-tint"></i>
                                <span>65% RH</span>
                            </div>
                        </div>
                    </div>
                    <div class="stage-status completed">
                        <i class="fas fa-check-circle"></i>
                        <span>Completed</span>
                    </div>
                </div>

                <!-- Storage Stage -->
                <div class="timeline-stage active" data-stage="storage">
                    <div class="stage-icon">
                        <i class="fas fa-warehouse"></i>
                    </div>
                    <div class="stage-content">
                        <div class="stage-header">
                            <h3>Storage</h3>
                            <span class="stage-date">Nov 16, 2024 - Present</span>
                        </div>
                        <div class="stage-details">
                            <div class="detail-item">
                                <i class="fas fa-warehouse"></i>
                                <span>Storage Unit A, Warehouse 1</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-user-tie"></i>
                                <span>Stored by: Priya Sharma</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-box"></i>
                                <span>Storage ID: ST-2024-001</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-shield-alt"></i>
                                <span>Security: Monitored 24/7</span>
                            </div>
                        </div>
                        <div class="stage-iot">
                            <div class="iot-badge temperature">
                                <i class="fas fa-thermometer-half"></i>
                                <span>22.5°C</span>
                            </div>
                            <div class="iot-badge humidity">
                                <i class="fas fa-tint"></i>
                                <span>65% RH</span>
                            </div>
                            <div class="iot-badge air-quality">
                                <i class="fas fa-wind"></i>
                                <span>Good AQI</span>
                            </div>
                        </div>
                    </div>
                    <div class="stage-status active">
                        <i class="fas fa-clock"></i>
                        <span>In Progress</span>
                    </div>
                </div>

                <!-- Transport Stage -->
                <div class="timeline-stage pending" data-stage="transport">
                    <div class="stage-icon">
                        <i class="fas fa-truck"></i>
                    </div>
                    <div class="stage-content">
                        <div class="stage-header">
                            <h3>Transport</h3>
                            <span class="stage-date">Scheduled: Nov 20, 2024</span>
                        </div>
                        <div class="stage-details">
                            <div class="detail-item">
                                <i class="fas fa-truck"></i>
                                <span>Vehicle: MH-12-AB-1234</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-user"></i>
                                <span>Driver: Arjun Patel</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-route"></i>
                                <span>Route: Nashik → Mumbai</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-clock"></i>
                                <span>ETA: 6 hours</span>
                            </div>
                        </div>
                        <div class="stage-iot">
                            <div class="iot-badge gps">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Live GPS</span>
                            </div>
                            <div class="iot-badge">
                                <i class="fas fa-thermometer-half"></i>
                                <span>Monitoring</span>
                            </div>
                        </div>
                    </div>
                    <div class="stage-status pending">
                        <i class="fas fa-hourglass-half"></i>
                        <span>Scheduled</span>
                    </div>
                </div>

                <!-- Delivery Stage -->
                <div class="timeline-stage pending" data-stage="delivery">
                    <div class="stage-icon">
                        <i class="fas fa-shipping-fast"></i>
                    </div>
                    <div class="stage-content">
                        <div class="stage-header">
                            <h3>Delivery</h3>
                            <span class="stage-date">Scheduled: Nov 20, 2024</span>
                        </div>
                        <div class="stage-details">
                            <div class="detail-item">
                                <i class="fas fa-building"></i>
                                <span>Destination: Mumbai Wholesale Market</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-user"></i>
                                <span>Receiver: Suresh Enterprises</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-clipboard-check"></i>
                                <span>Delivery Note: DN-2024-456</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-signature"></i>
                                <span>Digital signature required</span>
                            </div>
                        </div>
                        <div class="stage-iot">
                            <div class="iot-badge">
                                <i class="fas fa-qrcode"></i>
                                <span>QR Code</span>
                            </div>
                            <div class="iot-badge">
                                <i class="fas fa-camera"></i>
                                <span>Photo Proof</span>
                            </div>
                        </div>
                    </div>
                    <div class="stage-status pending">
                        <i class="fas fa-hourglass-half"></i>
                        <span>Pending</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Blockchain Verification Section -->
        <div class="verification-section">
            <h2><i class="fas fa-shield-alt"></i> Blockchain Verification</h2>
            <div class="verification-container">
                <div class="verification-card">
                    <div class="verification-header">
                        <div class="verification-icon">
                            <i class="fas fa-certificate"></i>
                        </div>
                        <div class="verification-info">
                            <h3>Authenticity Certificate</h3>
                            <p>Verify the authenticity of this crop batch</p>
                        </div>
                    </div>
                    <div class="verification-details">
                        <div class="detail-row">
                            <span class="label">Batch ID:</span>
                            <span class="value">BATCH-WHEAT-001-2024</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Blockchain Hash:</span>
                            <div class="hash-container">
                                <span class="hash-text">0x742d35cc6634c0532925a3b844bc9e7595f2b9e1</span>
                                <button class="copy-btn" onclick="copyHash('0x742d35cc6634c0532925a3b844bc9e7595f2b9e1')">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        <div class="detail-row">
                            <span class="label">Verification Status:</span>
                            <span class="status verified">
                                <i class="fas fa-check-circle"></i>
                                Verified
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Last Verified:</span>
                            <span class="value">2 minutes ago</span>
                        </div>
                    </div>
                    <div class="verification-actions">
                        <button class="verify-btn primary" id="verifyAuthenticity">
                            <i class="fas fa-search"></i>
                            Verify Authenticity
                        </button>
                        <button class="verify-btn secondary" id="viewCertificate">
                            <i class="fas fa-file-alt"></i>
                            View Certificate
                        </button>
                    </div>
                </div>

                <!-- QR Code Section -->
                <div class="qr-section">
                    <h4>Quick Access QR Code</h4>
                    <div class="qr-container">
                        <div class="qr-code">
                            <i class="fas fa-qrcode" style="font-size: 120px; color: var(--primary-color);"></i>
                        </div>
                        <p>Scan to verify authenticity</p>
                    </div>
                    <div class="qr-actions">
                        <button class="qr-btn" id="downloadQR">
                            <i class="fas fa-download"></i>
                            Download
                        </button>
                        <button class="qr-btn" id="shareQR">
                            <i class="fas fa-share"></i>
                            Share
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Historical Data Section -->
        <div class="historical-section">
            <h2><i class="fas fa-chart-line"></i> Historical IoT Data</h2>
            <div class="chart-container">
                <canvas id="iotChart" width="400" height="200"></canvas>
            </div>
            <div class="chart-controls">
                <button class="chart-btn active" data-period="24h">24H</button>
                <button class="chart-btn" data-period="7d">7D</button>
                <button class="chart-btn" data-period="30d">30D</button>
                <button class="chart-btn" data-period="all">All</button>
            </div>
        </div>

        <!-- Alerts Section -->
        <div class="alerts-section">
            <h2><i class="fas fa-bell"></i> IoT Alerts & Notifications</h2>
            <div class="alerts-container">
                <div class="alert-item warning">
                    <div class="alert-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="alert-content">
                        <h4>Temperature Warning</h4>
                        <p>Temperature exceeded optimal range (25°C) for 15 minutes</p>
                        <span class="alert-time">10 minutes ago</span>
                    </div>
                    <div class="alert-actions">
                        <button class="alert-btn">View Details</button>
                    </div>
                </div>
                <div class="alert-item info">
                    <div class="alert-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="alert-content">
                        <h4>Sensor Maintenance</h4>
                        <p>Humidity sensor calibration completed successfully</p>
                        <span class="alert-time">1 hour ago</span>
                    </div>
                    <div class="alert-actions">
                        <button class="alert-btn">Acknowledge</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal-overlay" id="verificationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-shield-alt"></i> Blockchain Verification</h3>
                <button class="close-btn" onclick="hideModal('verificationModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="verification-process">
                    <div class="process-step completed">
                        <div class="step-icon">
                            <i class="fas fa-check"></i>
                        </div>
                        <div class="step-content">
                            <h4>Connecting to Blockchain</h4>
                            <p>Establishing secure connection...</p>
                        </div>
                    </div>
                    <div class="process-step completed">
                        <div class="step-icon">
                            <i class="fas fa-check"></i>
                        </div>
                        <div class="step-content">
                            <h4>Verifying Hash</h4>
                            <p>Comparing blockchain records...</p>
                        </div>
                    </div>
                    <div class="process-step active">
                        <div class="step-icon">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                        <div class="step-content">
                            <h4>Validating IoT Data</h4>
                            <p>Checking sensor data integrity...</p>
                        </div>
                    </div>
                    <div class="process-step pending">
                        <div class="step-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="step-content">
                            <h4>Final Verification</h4>
                            <p>Generating certificate...</p>
                        </div>
                    </div>
                </div>
                <div class="verification-result" id="verificationResult" style="display: none;">
                    <div class="result-success">
                        <i class="fas fa-check-circle"></i>
                        <h3>Verification Successful!</h3>
                        <p>This crop batch is authentic and verified on the blockchain.</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn secondary" onclick="hideModal('verificationModal')">Close</button>
                <button class="btn primary" id="downloadCertificate" style="display: none;">
                    <i class="fas fa-download"></i>
                    Download Certificate
                </button>
            </div>
        </div>
    </div>

    <!-- Certificate Modal -->
    <div class="modal-overlay" id="certificateModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-certificate"></i> Authenticity Certificate</h3>
                <button class="close-btn" onclick="hideModal('certificateModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="certificate">
                    <div class="certificate-header">
                        <div class="certificate-logo">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <h2>AgroChain Authenticity Certificate</h2>
                    </div>
                    <div class="certificate-content">
                        <div class="certificate-info">
                            <h4>Certificate Details</h4>
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="label">Certificate ID:</span>
                                    <span class="value">CERT-2024-001</span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Batch ID:</span>
                                    <span class="value">BATCH-WHEAT-001-2024</span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Issue Date:</span>
                                    <span class="value">November 18, 2024</span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Valid Until:</span>
                                    <span class="value">November 18, 2025</span>
                                </div>
                            </div>
                        </div>
                        <div class="blockchain-info">
                            <h4>Blockchain Verification</h4>
                            <div class="hash-display">
                                <span class="hash-label">Transaction Hash:</span>
                                <span class="hash-value">0x742d35cc6634c0532925a3b844bc9e7595f2b9e1</span>
                            </div>
                            <div class="verification-badge">
                                <i class="fas fa-check-circle"></i>
                                Verified on Blockchain
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn secondary" onclick="hideModal('certificateModal')">Close</button>
                <button class="btn primary" onclick="downloadCertificate()">
                    <i class="fas fa-download"></i>
                    Download PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <div class="toast-content">
            <i class="fas fa-check-circle"></i>
            <span class="toast-message">Success!</span>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
            </div>
            <p>Processing...</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="iot-traceability.js"></script>
</body>
</html>